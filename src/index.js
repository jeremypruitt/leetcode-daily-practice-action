const core = require("@actions/core");
const { Octokit } = require("octokit"); // https://github.com/octokit/octokit.js
const dayjs = require("dayjs");
const mock = [
  'åˆ«ç©æ¸¸æˆäº†ï¼Œåˆ«äººéƒ½è¶…è¿‡ä½ äº†ï¼',
  'â¤ï¸ è®©å¤§å®¶åœ¨æ­£ç¡®çš„è·¯ä¸Šæºæ‰‹è¶Šèµ°è¶Šè¿œå§ï¼',
  'ç„å‡†æ’è¡Œæ¦œçš„ç¬¬ä¸€åï¼http://123.56.222.177/',
  'ä»Šå¤©ä½ æ‰“å¡äº†å—ï¼',
  'ä½ å·²ç»å¤šå°‘æ¬¡å½“å¤©æ²¡æ‰“å¡å•¦ï¼èµ¶ç´§åŠ æ²¹å‘€ï¼ŒğŸƒâ€â™€ï¸èµ¶ä¸Šå¤§éƒ¨é˜Ÿï¼',
  'å†²å•Šï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼',
  'æ²¡æœ‰å¯¹æ¯”å°±æ²¡æœ‰ä¼¤å®³ã€‚ã€‚æ¥ï¼Œé¢å¯¹ç°å®å§ï¼šhttp://123.56.222.177/',
  'æ“¦å¹²çœ¼æ³ªï¼Œç»§ç»­åŠ æ²¹ï¼ï¼ï¼å†²å†²å†²~~~',
  'ä»Šå¤©å’Œå¤§ä½¬äº¤æµäº†ä¸‹åˆ·é¢˜ï¼Œæƒ³é—®é—®å¤§ä½¬æœ‰æ²¡æœ‰è¯€çªï¼Œä»–å°±å›äº†ä¸€å¥è¯ï¼šâ€œå°±åˆ·å‘€ï¼Œåˆ·å‘€ã€‚é‡å˜å¼•èµ·è´¨å˜ã€‚â€åŠ æ²¹å§ï¼Œxdmï¼',
  'åŠ æ²¹å§ï¼Œxdmï¼',
  'ä¸æ‰é˜Ÿï¼',
  'ä»Šå¤©æ²¡æœ‰å¤´å“¥çš„é¸¡æ±¤~',
  ':exclamation: æ˜¨å¤©è¯·å‡çš„ï¼Œè®°å¾—è¡¥ä¸Šæ˜¨å¤©çš„é¢˜ï¼ä¸è¦é—ç•™ï¼Œé—ç•™å®¹æ˜“æ”¾å¼ƒï¼ï¼ï¼ï¼',
  `éå®é™æ— ä»¥è‡´è¿œ ğŸ’ªğŸ’ªğŸ’ª
  æˆ‘ä»¬å·²ç»ä¸€èµ·åšæŒè¿™ä¹ˆå¤šå¤©å•¦ âœŠ
  ç»§ç»­åŠ æ²¹ï¼Œé¡¶å³°ç›¸è§ã€‚ğŸŒ`,
  'ç»§ç»­åŠ æ²¹ï¼Œé¡¶å³°ç›¸è§ã€‚ğŸŒ',
  'ä»Šæ—¥æ‰“å¡ç»§ç»­ï¼Œå¤§å®¶åŠ æ²¹ï¼è·‘èµ·æ¥ï¼Œé¡¶å³°ç›¸è§ï¼',
  'å¥½çš„å¼€å§‹ï¼Œå¤§å®¶ä¸€èµ·è·‘èµ·æ¥ï¼Œè®©æˆ‘ä»¬é¡¶å³°ç›¸è§ã€‚'
]
const len = mock.length

try {
  const token = core.getInput("token");
  const octokit = new Octokit({
    auth: token,
  });

  // https://github.com/octokit/octokit.js#rest-api
  octokit.rest.issues.create({
    owner: "xingorg1",
    repo: "leetcode-daily-practice-action",
    title: `ã€æ¯æ—¥æ‰“å¡ã€‘${getDate()}`,
    body: getBody(),
  }).then((res) => {
    console.log("issueåˆ›å»ºæˆåŠŸå•¦ï¼ï¼", JSON.stringify(res));
  }).catch((err) => {
    console.log('issueåˆ›å»ºå¤±è´¥', err);
  })

  function getBody() {
    return `${mock[Math.floor(Math.random() * len)]}
## è¯„è®ºæ ¼å¼ - ç¤ºä¾‹ï¼š
\`\`\`txt
å°çŸ³å¤´ï¼šhttps://leetcode-cn.com/u/xingorg1/
ç»ƒä¹ å†…å®¹ï¼šé˜Ÿåˆ—å®ç°
ç´¯è®¡æ€»æ•°ï¼š100
ä»Šæ—¥å¢åŠ ï¼š1
\`\`\`
`;
  }

  function getDate() {
    // è¿è¡Œç¯å¢ƒæ˜¯ UTC æ—¶åŒº
    // éœ€è¦è½¬æ¢æˆ ä¸­å›½æ—¶åŒº
    // ä¸­å›½æ—¶åŒº = UTCæ—¶åŒº + 8å°æ—¶
    return dayjs().add("8", "hour").format("YYYY-MM-DD");
  }

} catch (err) {
  console.log('end-error', err);
}
